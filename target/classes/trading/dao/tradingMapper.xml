<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="tradingSQL">

<!-- 공통 : 특정 회원 주문 정보 호출-->
<select id="getOrderList"  parameterType="String" resultType="order">
	SELECT * from ORDERS where ORDER_ID=#{id}
</select>

<!-- 공통 : 특정 회원 쿠폰 정보 호출-->
<select id="getCouponList"  parameterType="String" resultType="coupon">
	SELECT * from BENEFIT_GRANT
	inner join COUPON_BOOK
	on BENEFIT_GRANT.coupon_no = COUPON_BOOK.coupon_no
	where GRANT_ID=#{id}
</select>

<!-- 장바구니 : 특정 회원 장바구니 정보 호출-->
<select id="getCartList"  parameterType="String" resultType="cart">
	SELECT * from SHOPPINGCART where MEMBERID=#{memberid}
</select>

<!-- 장바구니 : 회원 장바구니 생성 -->
<insert id="insertCartList">
	INSERT into SHOPPINGCART values(CART_SEQ.nextval,#{memberid},#{cartList_json})
</insert>

<!-- 장바구니 : 회원 장바구니 갱신 -->
<update id="updateCartList">
	UPDATE SHOPPINGCART set cartList_json=#{cartList_json} where MEMBERID=#{memberid}
</update>

<!-- 쿠폰 : 등록된 쿠폰 목록 가져오기 -->
<select id="getCouponBook" resultType="coupon">
	select * from COUPON_BOOK
</select>

<!-- 쿠폰 : 쿠폰 목록에 쿠폰 등록하기 -->
<insert id="makeCoupon" parameterType="coupon">
	insert into COUPON_BOOK values(coupon_seq.nextVal,
									#{coupon_name},
									#{coupon_type},
									#{discount_mount},
									#{coupon_target})
</insert>

<!-- 쿠폰 : 쿠폰 목록의 쿠폰 수정하기 -->
<update id="modifyCoupon" parameterType="coupon">
	UPDATE COUPON_BOOK set COUPON_NAME=#{coupon_name},
						   COUPON_TYPE=#{coupon_type},
						   DISCOUNT_MOUNT=#{discount_mount},
						   COUPON_TARGET=#{coupon_target}
						   where COUPON_NO = #{coupon_no}
</update>

<!-- 쿠폰 : 특정 번호로 발행된 쿠폰 목록 호출하기 -->
<select id="getSelectedCoupon" parameterType="String" resultType="coupon">
	select * from COUPON_BOOK where COUPON_NO = #{coupon_no}
</select>

<!-- 쿠폰 : 특정 번호로 지급된 쿠폰 목록 호출하기 -->
<select id="getGivenCoupon" parameterType="String" resultType="coupon">
	select * from BENEFIT_GRANT where COUPON_NO = #{coupon_no}
</select>

<!-- 쿠폰 : 쿠폰 목록의 쿠폰 삭제하기 -->
<delete id="deleteCoupon" parameterType="String">
	DELETE COUPON_BOOK where COUPON_NO = #{coupon_no}
</delete>

<!-- 쿠폰 : 쿠폰 지급 -->
<insert id="setCoupon" parameterType="coupon">
	INSERT into BENEFIT_GRANT values(#{grant_id},#{coupon_no},#{coupon_duedate},#{personal_code})
</insert>

<!-- 쿠폰: 해당 회원 지급 쿠폰 삭제하기(사유:쿠폰 사용) -->
<delete id="usedUserBenefit" parameterType="String">
	update BENEFIT_GRANT set personal_code=null where coupon_no = #{coupon_no} and grant_id=#{id} 
</delete>

<!-- 쿠폰: 해당 회원 지급 쿠폰 삭제하기(사유:계정삭제) -->
<delete id="deleteUserBenefit" parameterType="String">
	delete BENEFIT_GRANT where grant_id=#{id}
</delete>

<!-- 주문 : 비밀번호 변경 -->
<update id="setNewOrderPwd" parameterType="order">
	UPDATE ORDERS set order_pwd=#{order_pwd} where order_no=#{order_no}
</update>

<!-- 이벤트 : 배너리스트 호출 -->
<select id="getBannerList" resultType="event">
	SELECT * from EVENT
</select>

<!-- 이벤트 : 특정 배너 정보 호출 -->
<select id="getSelectedBanner" parameterType="String" resultType="event">
	SELECT * from EVENT where EVENT_NO=#{event_no}
</select>

<!-- 이벤트 : 특정 배너 정보 수정 -->
<update id="bannerModify" parameterType="event">
	UPDATE EVENT set EVENT_NAME=#{event_name},EVENT_IMAGE=#{event_image},EVENT_URL=#{event_url},
	EVENT_STARTDATE=#{event_startdate},EVENT_ENDDATE=#{event_enddate} where EVENT_NO=#{event_no}
</update>

</mapper>












